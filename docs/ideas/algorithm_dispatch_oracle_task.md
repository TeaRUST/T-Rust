# Design principles

We encourage the hosting node to put more TEA deposit. So the higher TEA deposit, the higher chance for them to get high value task running. 

The TEA deposit is the CML total supply(total reserve in TEA of bonding curve). The miner doesn't have to create a bonding curve entity. The miner can pay all deposit on his own. That means a theta == 100, flat bonding curve that owned by the miner self.  No one else can invest.  Refer to [three_types_of_entity](three_types_of_entity.md)

# Algorithm

This only apply to hosting nodes, not state maintainer, since they do not run oracle tasks.

## Caclulate the weight for all hosting nodes

The weight of a hosting node is calculated based on the following factors

* The total deposit (total supply total reserve in TEA). For none profilt nodes, this value will be set to the max of all other profitable nodes.
* Accumulated credit. (this is a credit value, we do not have it yet)

## Sort all hosting nodes descend of weight

The largest weight hosting node stays the head of this queue.

## Each state maintainer nodes generate a random number. Cosnensus calcualte the min of all of them

We currently use coveyor to find the smallest random nonce from all the random number generated by every state maintainer node. 

## Map this smallest none to the array space sorted by hosting nodes' weight

If a node happens fall into this nonce in space, it is the winner

## Skip the busy nodes

If a hosting node is overloaded, skip it, try to get the one next to this busy node.(the right neighbor)
